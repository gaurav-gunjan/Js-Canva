<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas Group/Ungroup</title>
    <style>
        canvas {
            border: 1px solid black;
        }
    </style>
</head>

<body>
    <canvas id="canvas" width="400" height="400"></canvas>
    <button onclick="groupObjects()">Group</button>
    <button onclick="ungroupObjects()">Ungroup</button>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const objects = []; // Store all objects drawn on the canvas

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            objects.forEach(obj => obj.draw());
        }

        function groupObjects() {
            const selectedObjects = objects.filter(obj => obj.isSelected);
            if (selectedObjects.length > 1) {
                const group = {
                    isSelected: false, // Groups can't be selected individually
                    objects: selectedObjects,
                    draw() {
                        this.objects.forEach(obj => obj.draw());
                    }
                };
                objects.push(group);
                selectedObjects.forEach(obj => {
                    const index = objects.indexOf(obj);
                    objects.splice(index, 1); // Remove individual objects from the canvas
                });
                draw();
            }
        }

        function ungroupObjects() {
            const selectedGroup = objects.find(obj => obj.isSelected && Array.isArray(obj.objects));
            if (selectedGroup) {
                const index = objects.indexOf(selectedGroup);
                objects.splice(index, 1); // Remove group from the canvas
                selectedGroup.objects.forEach(obj => objects.push(obj)); // Add individual objects back to the canvas
                draw();
            }
        }

        // Example object constructor
        function Rectangle(x, y, width, height, isSelected) {
            this.x = x;
            this.y = y;
            this.width = width;
            this.height = height;
            this.isSelected = isSelected || false;

            this.draw = function () {
                ctx.beginPath();
                ctx.rect(this.x, this.y, this.width, this.height);
                ctx.fillStyle = this.isSelected ? 'red' : 'blue';
                ctx.fill();
                ctx.closePath();
            };
        }

        // Example: Create some objects
        const rect1 = new Rectangle(50, 50, 50, 50);
        const rect2 = new Rectangle(150, 150, 50, 50);
        const rect3 = new Rectangle(250, 250, 50, 50);

        // Add objects to the array
        objects.push(rect1, rect2, rect3);

        // Initial draw
        draw();
    </script>
</body>

</html>